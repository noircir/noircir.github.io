<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>2019-09-04-Toronto_MCI.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">noircir-title</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="DataScience.html">Data Science</a>
</li>
<li>
  <a href="cloudComputing.html">Cloud Computing</a>
</li>
<li>
  <a href="EverythingElse.html">Everything else</a>
</li>
<li>
  <a href="About.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<p><link rel="stylesheet" href="styles.css" type="text/css"></p>
<div id="toronto-major-crime-indicators-2014-2018" class="section level1">
<h1>Toronto Major Crime Indicators 2014-2018</h1>
<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<p>Toronto Police made publicly available its data on the <strong><a href="https://data.torontopolice.on.ca/search?tags=MCI">“Toronto Police Service Public Safety Data Portal”</a></strong>.</p>
<p>We are interested in exploring the <strong><a href="https://data.torontopolice.on.ca/datasets/mci-2014-to-2018">Major Crime Indicatiors (MCI) for 2014-2018</a></strong>.</p>
<p><img src="assets/01_MCI_data.png" /></p>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>2. Exploratory Data Analysis</h2>
<p><img src="assets/02b_libraries.png" /></p>
<p>Let’s load the data:</p>
<pre class="r"><code>toronto &lt;- fread(&#39;./assets/MCI_2014_to_2018.csv&#39;)</code></pre>
</div>
<div id="data-preparation-data-munging" class="section level2">
<h2>3. Data Preparation (Data Munging)</h2>
<p>What features are available?</p>
<pre class="r"><code>names(toronto)</code></pre>
<pre><code>##  [1] &quot;X&quot;                   &quot;Y&quot;                   &quot;Index_&quot;             
##  [4] &quot;event_unique_id&quot;     &quot;occurrencedate&quot;      &quot;reporteddate&quot;       
##  [7] &quot;premisetype&quot;         &quot;ucr_code&quot;            &quot;ucr_ext&quot;            
## [10] &quot;offence&quot;             &quot;reportedyear&quot;        &quot;reportedmonth&quot;      
## [13] &quot;reportedday&quot;         &quot;reporteddayofyear&quot;   &quot;reporteddayofweek&quot;  
## [16] &quot;reportedhour&quot;        &quot;occurrenceyear&quot;      &quot;occurrencemonth&quot;    
## [19] &quot;occurrenceday&quot;       &quot;occurrencedayofyear&quot; &quot;occurrencedayofweek&quot;
## [22] &quot;occurrencehour&quot;      &quot;MCI&quot;                 &quot;Division&quot;           
## [25] &quot;Hood_ID&quot;             &quot;Neighbourhood&quot;       &quot;Lat&quot;                
## [28] &quot;Long&quot;                &quot;ObjectId&quot;</code></pre>
<p>The structure of the dataset:</p>
<pre class="r"><code>str(toronto)</code></pre>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   167525 obs. of  29 variables:
##  $ X                  : num  -79.3 -79.5 -79.5 -79.6 -79.5 ...
##  $ Y                  : num  43.7 43.8 43.7 43.7 43.7 ...
##  $ Index_             : int  214 215 216 217 218 219 220 221 222 223 ...
##  $ event_unique_id    : chr  &quot;GO-20141948968&quot; &quot;GO-20141950728&quot; &quot;GO-20141956416&quot; &quot;GO-20141956867&quot; ...
##  $ occurrencedate     : chr  &quot;2014-04-24T11:29:00.000Z&quot; &quot;2014-04-24T13:00:00.000Z&quot; &quot;2014-04-25T13:20:00.000Z&quot; &quot;2014-04-24T17:00:00.000Z&quot; ...
##  $ reporteddate       : chr  &quot;2014-04-24T12:46:00.000Z&quot; &quot;2014-04-24T15:58:00.000Z&quot; &quot;2014-04-25T13:52:00.000Z&quot; &quot;2014-04-25T10:30:00.000Z&quot; ...
##  $ premisetype        : chr  &quot;Commercial&quot; &quot;House&quot; &quot;Apartment&quot; &quot;Outside&quot; ...
##  $ ucr_code           : int  1610 2120 1430 1430 1430 1430 1430 1420 1420 1420 ...
##  $ ucr_ext            : int  200 200 100 100 100 100 100 100 100 100 ...
##  $ offence            : chr  &quot;Robbery - Mugging&quot; &quot;B&amp;E&quot; &quot;Assault&quot; &quot;Assault&quot; ...
##  $ reportedyear       : int  2014 2014 2014 2014 2014 2014 2014 2014 2014 2014 ...
##  $ reportedmonth      : chr  &quot;April&quot; &quot;April&quot; &quot;April&quot; &quot;April&quot; ...
##  $ reportedday        : int  24 24 25 25 25 25 3 3 3 3 ...
##  $ reporteddayofyear  : int  114 114 115 115 115 115 123 123 123 123 ...
##  $ reporteddayofweek  : chr  &quot;Thursday&quot; &quot;Thursday&quot; &quot;Friday&quot; &quot;Friday&quot; ...
##  $ reportedhour       : int  12 15 13 10 16 22 3 4 4 4 ...
##  $ occurrenceyear     : int  2014 2014 2014 2014 2014 2014 2014 2014 2014 2014 ...
##  $ occurrencemonth    : chr  &quot;April&quot; &quot;April&quot; &quot;April&quot; &quot;April&quot; ...
##  $ occurrenceday      : int  24 24 25 24 25 25 3 3 3 3 ...
##  $ occurrencedayofyear: int  114 114 115 114 115 115 123 123 123 123 ...
##  $ occurrencedayofweek: chr  &quot;Thursday&quot; &quot;Thursday&quot; &quot;Friday&quot; &quot;Thursday&quot; ...
##  $ occurrencehour     : int  11 13 13 17 16 22 1 4 4 4 ...
##  $ MCI                : chr  &quot;Robbery&quot; &quot;Break and Enter&quot; &quot;Assault&quot; &quot;Assault&quot; ...
##  $ Division           : chr  &quot;D55&quot; &quot;D31&quot; &quot;D12&quot; &quot;D23&quot; ...
##  $ Hood_ID            : int  68 24 30 4 114 73 64 79 79 79 ...
##  $ Neighbourhood      : chr  &quot;North Riverdale (68)&quot; &quot;Black Creek (24)&quot; &quot;Brookhaven-Amesbury (30)&quot; &quot;Rexdale-Kipling (4)&quot; ...
##  $ Lat                : num  43.7 43.8 43.7 43.7 43.7 ...
##  $ Long               : num  -79.3 -79.5 -79.5 -79.6 -79.5 ...
##  $ ObjectId           : int  1 2 3 4 5 6 7 8 9 10 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p>Dimensions:</p>
<pre class="r"><code>dim(toronto)</code></pre>
<pre><code>## [1] 167525     29</code></pre>
<p>Are there duplicated event ids?</p>
<pre class="r"><code>toronto_dupl_ids &lt;- subset(toronto, duplicated(toronto$event_unique_id))
dim(toronto_dupl_ids)</code></pre>
<pre><code>## [1] 21708    29</code></pre>
<pre class="r"><code>toronto_dupl_rows &lt;- duplicated(toronto)
dim(toronto_dupl_rows)</code></pre>
<pre><code>## NULL</code></pre>
<pre class="r"><code>distinct_ids &lt;- distinct(select(toronto, event_unique_id))
dim(distinct_ids)</code></pre>
<pre><code>## [1] 145817      1</code></pre>
<p>The dataset has 21708 duplicated event ids, - almost 13%, though no duplicate rows. Some events have the same ids but are split into several offences.</p>
<pre class="r"><code>nrow(toronto_dupl_ids) / nrow(toronto) * 100</code></pre>
<pre><code>## [1] 12.95807</code></pre>
<p><br> Let’s drop the duplicates:</p>
<pre class="r"><code>toronto &lt;- subset(toronto, !duplicated(toronto$event_unique_id))
dim(toronto)</code></pre>
<pre><code>## [1] 145817     29</code></pre>
<p>In what years did the crimes occur?</p>
<pre class="r"><code>unique(toronto$occurrenceyear) %&gt;% sort()</code></pre>
<pre><code>##  [1] 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013
## [15] 2014 2015 2016 2017 2018</code></pre>
<p>When were the crimes reported?</p>
<pre class="r"><code>unique(toronto$reportedyear) %&gt;% sort()</code></pre>
<pre><code>## [1] 2014 2015 2016 2017 2018</code></pre>
<p>Let’s have a look at how many crimes were reported for each year.</p>
<pre class="r"><code>toronto %&gt;% group_by(occurrenceyear) %&gt;% summarise(n=n())</code></pre>
<pre><code>## # A tibble: 20 x 2
##    occurrenceyear     n
##             &lt;int&gt; &lt;int&gt;
##  1           2000    13
##  2           2001    10
##  3           2002     7
##  4           2003     8
##  5           2004     9
##  6           2005     8
##  7           2006     7
##  8           2007    16
##  9           2008    23
## 10           2009    28
## 11           2010    49
## 12           2011    66
## 13           2012   117
## 14           2013   452
## 15           2014 27829
## 16           2015 28045
## 17           2016 28274
## 18           2017 29746
## 19           2018 31070
## 20             NA    40</code></pre>
<p><br> The amount of crimes reported in the years 2014-2018 is exceeding the prior years by the order of magnitude. Let’s work with 2014-2018 crimes only, and remove prior years’ data.</p>
<pre class="r"><code>toronto &lt;- toronto[toronto$occurrenceyear == 2014 | toronto$occurrenceyear == 2015 | toronto$occurrenceyear == 2016 | toronto$occurrenceyear == 2017 | toronto$occurrenceyear == 2018,]
toronto %&gt;% group_by(occurrenceyear) %&gt;% summarise(n=n())</code></pre>
<pre><code>## # A tibble: 5 x 2
##   occurrenceyear     n
##            &lt;int&gt; &lt;int&gt;
## 1           2014 27829
## 2           2015 28045
## 3           2016 28274
## 4           2017 29746
## 5           2018 31070</code></pre>
<pre class="r"><code>dim(toronto)</code></pre>
<pre><code>## [1] 144964     29</code></pre>
<p>Let’s keep only the columns that we need.</p>
<pre class="r"><code>keep &lt;- c(&quot;event_unique_id&quot;, &quot;occurrencedate&quot;, &quot;premisetype&quot;, &quot;offence&quot;, &quot;occurrenceyear&quot;, &quot;occurrencemonth&quot;, &quot;occurrenceday&quot;, &quot;occurrencedayofweek&quot;, &quot;occurrencehour&quot;, &quot;MCI&quot;, &quot;Neighbourhood&quot;, &quot;Lat&quot;, &quot;Long&quot;)
toronto &lt;- subset(toronto, select = keep)
str(toronto)</code></pre>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   144964 obs. of  13 variables:
##  $ event_unique_id    : chr  &quot;GO-20141948968&quot; &quot;GO-20141950728&quot; &quot;GO-20141956416&quot; &quot;GO-20141956867&quot; ...
##  $ occurrencedate     : chr  &quot;2014-04-24T11:29:00.000Z&quot; &quot;2014-04-24T13:00:00.000Z&quot; &quot;2014-04-25T13:20:00.000Z&quot; &quot;2014-04-24T17:00:00.000Z&quot; ...
##  $ premisetype        : chr  &quot;Commercial&quot; &quot;House&quot; &quot;Apartment&quot; &quot;Outside&quot; ...
##  $ offence            : chr  &quot;Robbery - Mugging&quot; &quot;B&amp;E&quot; &quot;Assault&quot; &quot;Assault&quot; ...
##  $ occurrenceyear     : int  2014 2014 2014 2014 2014 2014 2014 2014 2014 2014 ...
##  $ occurrencemonth    : chr  &quot;April&quot; &quot;April&quot; &quot;April&quot; &quot;April&quot; ...
##  $ occurrenceday      : int  24 24 25 24 25 25 3 3 7 7 ...
##  $ occurrencedayofweek: chr  &quot;Thursday&quot; &quot;Thursday&quot; &quot;Friday&quot; &quot;Thursday&quot; ...
##  $ occurrencehour     : int  11 13 13 17 16 22 1 4 11 15 ...
##  $ MCI                : chr  &quot;Robbery&quot; &quot;Break and Enter&quot; &quot;Assault&quot; &quot;Assault&quot; ...
##  $ Neighbourhood      : chr  &quot;North Riverdale (68)&quot; &quot;Black Creek (24)&quot; &quot;Brookhaven-Amesbury (30)&quot; &quot;Rexdale-Kipling (4)&quot; ...
##  $ Lat                : num  43.7 43.8 43.7 43.7 43.7 ...
##  $ Long               : num  -79.3 -79.5 -79.5 -79.6 -79.5 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
</div>
<div id="data-exploration" class="section level2">
<h2>4. Data Exploration</h2>
<div id="to-do-the-same-as-below-but-for-each-of-the-5-years-2014-to-2018" class="section level3">
<h3>To do: the same as below, but for each of the 5 years: 2014 to 2018</h3>
<p>The majority of crimes is “Assault”:</p>
<pre class="r"><code># Here, geom_bar(stat=&quot;bin&quot;) by default, counting cases in each group of MCI
ggplot(toronto, aes(x = MCI)) + 
  geom_bar(width = 0.5) + 
  labs(title = &quot;Major Crime Indicators Toronto 2014-2018&quot;, 
       x=&quot;Major Crime Indicators&quot;, 
       y=&quot;Number of Occurences&quot;) +
  theme_economist() +
  theme(
    axis.title = element_text(size = 12, face = &quot;bold&quot;),
    axis.title.x = element_text(color=&quot;forestgreen&quot;, vjust=-0.35),
    axis.title.y = element_text(color=&quot;dodgerblue4&quot; , vjust=0.35)
    )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/MCI%20histogram-1.png" width="672" /></p>
</div>
<div id="what-were-the-major-crimes-in-toronto-in-2014-2018-overall" class="section level3">
<h3>What were the major crimes in Toronto in 2014-2018, overall?</h3>
<pre class="r"><code># To be able to reorder MCI data inside MCI, we need to create a separate n (count) column; 
# &quot;crime&quot; is a (5,2) dataframe with &quot;MCI&quot; and &quot;n&quot; columns.
crime &lt;- toronto %&gt;% group_by(MCI) %&gt;% summarise(n=n())
crime &lt;- crime[order(crime$n, decreasing = TRUE),]
crime</code></pre>
<pre><code>## # A tibble: 5 x 2
##   MCI                 n
##   &lt;chr&gt;           &lt;int&gt;
## 1 Assault         75004
## 2 Break and Enter 34314
## 3 Auto Theft      16505
## 4 Robbery         13958
## 5 Theft Over       5183</code></pre>
<pre class="r"><code>ggplot(data = crime, 
       aes(x = reorder(MCI, n), y = n)) +
  # Here, geom_bar(stat=&quot;identity&quot;) instructs to represent values of &quot;n&quot;
  geom_bar(stat = &#39;identity&#39;, 
           width = 0.4) +
  geom_text(aes(label = n), 
            hjust = -0.1, 
            size = 3) +
  # to prevent labels to be cut off
  scale_y_continuous(expand = c(.1, .1)) +
  coord_flip() +
  labs(title = &quot;Major Crime Indicators Toronto 2014-2018&quot;, 
       x=&quot;Major Crime Indicators&quot;, 
       y=&quot;Number of Occurences&quot;) +
  theme_solarized_2() +
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12, face = &quot;bold&quot;),
    axis.title.x = element_text(vjust=-0.35),
    axis.title.y = element_text(vjust=0.35)
    )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/MCI%20types%20-%20plot-1.png" width="672" /></p>
</div>
<div id="what-were-the-different-assault-types-which-one-is-the-worst" class="section level3">
<h3>What were the different assault types? Which one is the worst?</h3>
<pre class="r"><code># Grouping only those observations that have &quot;Assault&quot; in MCI column
assault_by_offence &lt;- toronto[toronto$MCI == &#39;Assault&#39;, ] %&gt;% group_by(offence) %&gt;% summarise(n=n())
assault_by_offence &lt;- assault_by_offence[order(assault_by_offence$n, decreasing = TRUE), ]
assault_by_offence</code></pre>
<pre><code>## # A tibble: 21 x 2
##    offence                            n
##    &lt;chr&gt;                          &lt;int&gt;
##  1 Assault                        53561
##  2 Assault With Weapon            11417
##  3 Assault Bodily Harm             2972
##  4 Assault Peace Officer           2144
##  5 Assault - Resist/ Prevent Seiz  1478
##  6 Aggravated Assault              1138
##  7 Discharge Firearm With Intent    713
##  8 Discharge Firearm - Recklessly   545
##  9 Pointing A Firearm               456
## 10 Administering Noxious Thing      153
## # … with 11 more rows</code></pre>
<pre class="r"><code>ggplot(data = assault_by_offence, 
       aes(x = reorder(offence, n), y = n)) +
  geom_bar(stat = &#39;identity&#39;, 
           width = 0.6) +
  geom_text(aes(label = n), 
            hjust = -0.1, 
            size = 3) +
  # to prevent labels to be cut off
  scale_y_continuous(expand = c(.1, .1)) +
  coord_flip() +
  labs(x = &quot;Types of Assault&quot;,
       y = &quot;Number of Occurrences&quot;,
       title = &quot;Assault Types Toronto 2014-2018&quot;) +
  theme_economist_white() +
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12, face = &quot;bold&quot;),
    axis.title.x = element_text(vjust=-0.4),
    axis.title.y = element_text(vjust=0.4)
    )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/assault%20types%20-%20plot-1.png" width="672" /></p>
</div>
<div id="the-top-offences" class="section level3">
<h3>The top offences</h3>
<p>What are other offences, in addition to assault?</p>
<pre class="r"><code>crime_by_offence &lt;- toronto %&gt;% group_by(offence) %&gt;%  summarise(n = n())
crime_by_offence &lt;- crime_by_offence[order(crime_by_offence$n, decreasing = TRUE), ]
crime_by_offence</code></pre>
<pre><code>## # A tibble: 49 x 2
##    offence                    n
##    &lt;chr&gt;                  &lt;int&gt;
##  1 Assault                53561
##  2 B&amp;E                    28901
##  3 Theft Of Motor Vehicle 16505
##  4 Assault With Weapon    11417
##  5 Robbery - Mugging       4705
##  6 B&amp;E W&#39;Intent            4503
##  7 Assault Bodily Harm     2972
##  8 Theft Over              2939
##  9 Robbery - Other         2171
## 10 Assault Peace Officer   2144
## # … with 39 more rows</code></pre>
<pre class="r"><code>ggplot(data = crime_by_offence, 
       aes(x = reorder(offence, n), y = n)) +
  geom_bar(stat = &#39;identity&#39;, 
           width = 0.7) +
  geom_text(aes(label = n), 
            hjust = -0.1, 
            size = 2) +
  coord_flip() +
  labs(x = &quot;Types of Offence&quot;,
       y = &quot;Number of Occurrences&quot;,
       title = &quot;Offence Types Toronto 2014-2018&quot;) +
  theme_economist() +
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12, face = &quot;bold&quot;), 
    axis.text.y = element_text(size = 6),
    axis.title.x = element_text(vjust=-0.4),
    axis.title.y = element_text(vjust=0.4)
    ) </code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/offence%20types%20-%20plot-1.png" width="672" /></p>
<p>The highest number of offences in toronto in 2014-2018 were: - assault - break and entering - assault with weapon</p>
<p>The second highest number of offences was: - robbery - mugging - breaking and entering with intent - assault wiht bodily harm - theft over</p>
<p>The third prominent group of offences: - robbery - other - robbery with weapon - assault peace officer</p>
</div>
<div id="total-crimes-by-the-hour-of-the-day" class="section level3">
<h3>Total crimes by the hour of the day</h3>
<pre class="r"><code>crime_hour &lt;- toronto %&gt;%  group_by(occurrencehour) %&gt;% summarise(n=n())

ggplot(data = crime_hour, aes(x=occurrencehour, y=n)) + 
  geom_bar(stat = &#39;identity&#39;, 
           width = 0.6,
           color = &quot;gray80&quot;,
           fill = &quot;gray80&quot;) +
  geom_line(size = 1.8, 
            alpha = 0.7, 
            color = &quot;mediumseagreen&quot;) +
  geom_point(size = 0.8) +  
  labs( x= &#39;Hour(24-hour clock)&#39;,
        y = &#39;Number of Occurrences&#39;,
        title = &#39;Total Crimes by Hour of Day in Toronto 2014-2018&#39;) +
  theme_bw() +
  theme(plot.title = element_text(size = 16, face = &quot;bold&quot;),
        axis.title = element_text(size = 12))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/by%20the%20hour%20of%20the%20day-1.png" width="672" /></p>
<p>The worst hour is around midnight, another peak time is around noon, followed by around 8pm.</p>
</div>
<div id="crime-types-by-hour-of-the-day" class="section level3">
<h3>Crime types by hour of the day</h3>
<pre class="r"><code># grouping by two features
hour.crime &lt;- toronto %&gt;% group_by(occurrencehour, MCI) %&gt;% summarise(n = n())
head(hour.crime)</code></pre>
<pre><code>## # A tibble: 6 x 3
## # Groups:   occurrencehour [2]
##   occurrencehour MCI                 n
##            &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
## 1              0 Assault          4479
## 2              0 Auto Theft       1042
## 3              0 Break and Enter  2279
## 4              0 Robbery           764
## 5              0 Theft Over        517
## 6              1 Assault          3345</code></pre>
<p>While assaults are the most common crimes throughout the day, they happened more frequently at noon, and then from late afternoons and until after midnight. Break and enter crimes happened more often in the mornings and at around the midnight (when no one was at home or in the office) . Robberies and auto thefts were more likely to happen in the late evenings. All of these patterns make sense.</p>
<pre class="r"><code>ggplot(data = hour.crime, 
       aes(x = occurrencehour, 
           y = n, 
           color = MCI)) +
  geom_line(size = 1.5) +
  labs( x= &#39;Hour (24-hour clock)&#39;,
        y = &#39;Number of Occurrences&#39;,
        title = &#39;Crime Types by Hour of Day in Toronto 2014-2018&#39;) +
  theme_bw() +
  theme(plot.title = element_text(size = 16, face = &quot;bold&quot;),
        axis.title = element_text(size = 12))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/MCI%20by%20hour%20of%20the%20day,%20over%205%20years-1.png" width="672" /></p>
</div>
<div id="crime-evolution-over-5-years-2014-2018" class="section level3">
<h3>Crime evolution over 5 years 2014-2018</h3>
<pre class="r"><code>year.crime &lt;- toronto %&gt;% group_by(occurrenceyear, MCI) %&gt;% summarise(n = n())

ggplot(data = year.crime, 
       aes(x = occurrenceyear, 
           y = n, 
           color = MCI)) +
  geom_line(size = 1.5) +
  #facet_grid(occurrenceyear ~ .) +
  labs( x= &#39;Year&#39;,
        y = &#39;Major Crime Indicators&#39;,
        title = &#39;Crime evolution in Toronto over 2014-2018&#39;) +
  theme_bw() +
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12),
    axis.title.x = element_text(vjust=-0.4)
    )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/MCI%20evolution%205%20years-1.png" width="672" /></p>
</div>
<div id="neighbourhoods-with-the-highest-amount-of-crime" class="section level3">
<h3>Neighbourhoods with the highest amount of crime</h3>
<pre class="r"><code>crime_by_location &lt;- toronto %&gt;% group_by(Neighbourhood) %&gt;%  summarise(n=n())
crime_by_location &lt;- crime_by_location[order(crime_by_location$n, decreasing = TRUE), ]
crime_by_location</code></pre>
<pre><code>## # A tibble: 141 x 2
##    Neighbourhood                              n
##    &lt;chr&gt;                                  &lt;int&gt;
##  1 Church-Yonge Corridor (75)              5335
##  2 Waterfront Communities-The Island (77)  4803
##  3 West Humber-Clairville (1)              3857
##  4 Moss Park (73)                          3152
##  5 Bay Street Corridor (76)                3036
##  6 Kensington-Chinatown (78)               2767
##  7 York University Heights (27)            2714
##  8 Woburn (137)                            2658
##  9 Downsview-Roding-CFB (26)               2536
## 10 Annex (95)                              2518
## # … with 131 more rows</code></pre>
<pre class="r"><code>crime_by_location_top20 &lt;- head(crime_by_location, 20)

ggplot(data = crime_by_location_top20,
      aes(x = reorder(Neighbourhood, n), y = n)
      ) +
  geom_bar(stat = &#39;identity&#39;, width = 0.6) +
  geom_text(aes(label = n), hjust = -0.1, size = 3) + 
  scale_y_continuous(expand = c(.1, .1)) +
  coord_flip() +
  labs( x= &#39;Number of Crime Occurences&#39;,
        y = &#39;Neighbourhoods&#39;,
        title = &#39;Neighbourhoods with Most Crimes - Top 20&#39;) +
  theme_bw() +
  theme(plot.title = element_text(size = 16, face = &quot;bold&quot;),
        axis.title = element_text(size = 12))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/crime%20by%20location%20-%20plot-1.png" width="672" /></p>
</div>
<div id="safest-neighbourhoods" class="section level3">
<h3>Safest neighbourhoods</h3>
<pre class="r"><code>tail(crime_by_location, 10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    Neighbourhood                           n
##    &lt;chr&gt;                               &lt;int&gt;
##  1 Forest Hill South (101)               343
##  2 Princess-Rosethorn (10)               343
##  3 Yonge-Eglinton (100)                  285
##  4 Markland Wood (12)                    280
##  5 Caledonia-Fairbank (109)              263
##  6 Broadview North (57)                  260
##  7 Centennial Scarborough (133)          257
##  8 Yonge-St.Clair (97)                   209
##  9 Lambton Baby Point (114)              161
## 10 Eringate-Centennial_West Deane (11)    23</code></pre>
</div>
<div id="top-offence-types-in-neighbourhoods" class="section level3">
<h3>Top offence types in neighbourhoods</h3>
<pre class="r"><code>offence_by_location &lt;- toronto %&gt;% group_by(Neighbourhood, offence) %&gt;% summarise(n=n())
offence_by_location &lt;- offence_by_location[order(offence_by_location$n, decreasing = T),]
offence_by_location_top20 &lt;- head(offence_by_location, 20)

ggplot(data = offence_by_location_top20, aes(x = Neighbourhood, y = n, fill = offence)) +
  geom_bar(stat=&#39;identity&#39;, width = 0.8, position = position_dodge()) +
  labs( x= &#39;Neighbourhood&#39;,
        y = &#39;Number of Occurrences&#39;,
        title = &#39;Top Offence Type vs. Neighbourhoods&#39;) +
  theme_bw() +
  theme(plot.title = element_text(size = 16, face = &quot;bold&quot;),
        axis.title = element_text(size = 12, face = &quot;bold&quot;),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = .4)
        ) </code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/top%20offence%20types%20in%20which%20neighbourhoods-1.png" width="672" /></p>
</div>
<div id="mci-by-month" class="section level3">
<h3>MCI by month</h3>
<pre class="r"><code>crime_count &lt;- toronto %&gt;% group_by(occurrencemonth, MCI) %&gt;% summarise(Total = n())
crime_count$occurrencemonth &lt;- ordered(crime_count$occurrencemonth, levels = c(&#39;January&#39;, &#39;February&#39;, &#39;March&#39;, &#39;April&#39;, &#39;May&#39;, &#39;June&#39;, &#39;July&#39;, &#39;August&#39;, &#39;September&#39;, &#39;October&#39;, &#39;November&#39;, &#39;December&#39;))

ggplot(crime_count, aes(occurrencemonth, MCI, fill = Total)) +
  geom_tile(size = 0.5, color = &quot;white&quot;) +
  scale_fill_viridis()  +
  geom_text(aes(label=Total), color = &quot;white&quot;) +
  labs( x= &#39;Month&#39;,
        y = &#39;MCI&#39;,
        title = &#39;Major Crime Indicators by Month Toronto 2014-2018&#39;) +
  theme(plot.title = element_text(size = 16), 
        axis.title = element_text(size = 12, face = &quot;bold&quot;),
        axis.text.x = element_text(angle = 50, hjust = .1, vjust = .1),
        axis.title.x = element_text(vjust = -0.1),
        axis.title.y = element_text(vjust = 0.6)
        )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/major%20crime%20indicators%20by%20month-1.png" width="672" /></p>
</div>
<div id="mci-by-day-of-the-week" class="section level3">
<h3>MCI by day of the week</h3>
<pre class="r"><code>crime_count &lt;- toronto %&gt;% group_by(occurrencedayofweek, MCI) %&gt;% summarise(Total = n())
crime_count$occurrencedayofweek &lt;- ordered(crime_count$occurrencedayofweek, levels = c(&#39;Monday&#39;, &#39;Tuesday&#39;, &#39;Wednesday&#39;, &#39;Thursday&#39;, &#39;Friday&#39;, &#39;Saturday&#39;, &#39;Sunday&#39;))

ggplot(crime_count, aes(occurrencedayofweek, MCI, fill = Total)) +
  geom_tile(size = 0.5, color = &quot;white&quot;) +
  scale_fill_viridis()  +
  geom_text(aes(label=Total), color = &quot;white&quot;) +
  labs( x= &#39;Day of Week&#39;,
        y = &#39;MCI&#39;,
        title = &#39;Major Crime Indicators by Day of Week Toronto 2014-2018&#39;) +
  theme(plot.title = element_text(size = 16), 
        axis.title = element_text(size = 12, face = &quot;bold&quot;),
        axis.text.x = element_text(angle = 50, hjust = 0.1, vjust = .1),
        axis.title.x = element_text(vjust = -0.1),
        axis.title.y = element_text(vjust = 0.1)
        )</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/major%20crime%20indicators%20by%20day%20of%20week-1.png" width="672" /></p>
</div>
<div id="to-do-seasonal-crime-patterns-temperature-change-daylight-hours-beginning-and-end-school-year" class="section level3">
<h3>To do: Seasonal crime patterns (temperature change, daylight hours, beginning and end school year)</h3>
</div>
<div id="to-do-homicides" class="section level3">
<h3>To do: Homicides</h3>
</div>
</div>
<div id="k-means-clustering" class="section level2">
<h2>5. K-means clustering</h2>
<p>The goal is to create clusters of neighbourhoods with similar crime level.</p>
<p>Let’s create a dataframe with neighbourhoods and major crimes, then spread it:</p>
<pre class="r"><code>groups &lt;- toronto %&gt;% group_by(Neighbourhood, MCI) %&gt;% summarise(n=n())
head(groups)</code></pre>
<pre><code>## # A tibble: 6 x 3
## # Groups:   Neighbourhood [2]
##   Neighbourhood                      MCI                 n
##   &lt;chr&gt;                              &lt;chr&gt;           &lt;int&gt;
## 1 Agincourt North (129)              Assault           325
## 2 Agincourt North (129)              Auto Theft        125
## 3 Agincourt North (129)              Break and Enter   289
## 4 Agincourt North (129)              Robbery           130
## 5 Agincourt North (129)              Theft Over         26
## 6 Agincourt South-Malvern West (128) Assault           479</code></pre>
<pre class="r"><code>groups_wide &lt;- spread(groups, key = MCI, value = n)
head(groups_wide)</code></pre>
<pre><code>## # A tibble: 6 x 6
## # Groups:   Neighbourhood [6]
##   Neighbourhood  Assault `Auto Theft` `Break and Ente… Robbery `Theft Over`
##   &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;            &lt;int&gt;   &lt;int&gt;        &lt;int&gt;
## 1 Agincourt Nor…     325          125              289     130           26
## 2 Agincourt Sou…     479          144              378     101           62
## 3 Alderwood (20)     148           71              124      31           33
## 4 Annex (95)        1245          107              771     232          163
## 5 Banbury-Don M…     344           77              338      41           41
## 6 Bathurst Mano…     354          168              240      62           50</code></pre>
<div id="remove-categorical-data" class="section level3">
<h3>Remove categorical data</h3>
<pre class="r"><code>z &lt;- groups_wide[, -c(1,1)]
# assure that there is no missing values
z &lt;- z[complete.cases(z),]</code></pre>
</div>
<div id="scale-data-for-comparison" class="section level3">
<h3>Scale data for comparison</h3>
<pre class="r"><code># find the mean of each feature
m &lt;- apply(z, 2, mean)
# find st.dev. of each feature
s &lt;- apply(z, 2, sd)
z &lt;- scale(z, m, s)
head(z)</code></pre>
<pre><code>##         Assault  Auto Theft Break and Enter     Robbery  Theft Over
## [1,] -0.4153584  0.05520376      0.27153985  0.31734166 -0.25910752
## [2,] -0.1062631  0.18724919      0.80107422  0.02054156  0.60788640
## [3,] -0.7706173 -0.32008324     -0.71018116 -0.69587249 -0.09052537
## [4,]  1.4311850 -0.06989190      3.13935516  1.36125927  3.04028604
## [5,] -0.3772232 -0.27838468      0.56308124 -0.59352763  0.10213995
## [6,] -0.3571521  0.35404341     -0.02000154 -0.37860341  0.31888843</code></pre>
</div>
<div id="determine-the-number-of-clusters-the-elbow-method" class="section level3">
<h3>Determine the number of clusters (the elbow method)</h3>
<p>Within-Cluster Sum of Squares WSS (the sum of the squared deviations from each observation and the cluster centroid). In other words, it’s a sample variance.</p>
<p><img src="assets/s-variance.png" /></p>
<p>WSS as a single value for the whole z dataset (?)</p>
<pre class="r"><code>wss &lt;- (nrow(z)-1) * sum(apply(z, 2, var)) # the variance is a squared deviation from the mean 
wss</code></pre>
<pre><code>## [1] 700</code></pre>
<p>WSS as an array of variances for possible values of k, from 2 to 20. withinss = Vector of within-cluster sum of squares, one component per cluster.</p>
<pre class="r"><code>for (i in 2:20) {
  wss[i] &lt;- sum(kmeans(z, centers=i)$withinss)
}
wss</code></pre>
<pre><code>##  [1] 700.00000 369.45787 266.50542 237.94558 228.89866 152.77542 213.41202
##  [8] 107.75724 103.22366  94.00327 201.06666  81.53333  78.68695  76.20141
## [15]  86.21518  72.59308  70.89679  66.22138  66.32382  64.85852</code></pre>
<p>Plotted WSS (type=‘b’ is for both: lines and points.)</p>
<pre class="r"><code>plot(1:20, wss, type=&#39;b&#39;, xlab=&#39;Number of Clusters&#39;, ylab=&#39;Within groups sum of squares&#39;)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/WSS%20plot-1.png" width="672" /></p>
<p>Based on the plot, we could choose either 5, 8, 9, or 10 clusters (subsequent runs slightly vary the plot, the reason TBD). We’ll choose the minumum (5 clusters) and then the maximum 10 clusters.</p>
</div>
<div id="fitting-a-model-k-5" class="section level3">
<h3>Fitting a model, K = 5</h3>
<pre class="r"><code>kc &lt;- kmeans(z, 5)
kc</code></pre>
<pre><code>## K-means clustering with 5 clusters of sizes 24, 9, 55, 17, 36
## 
## Cluster means:
##      Assault  Auto Theft Break and Enter     Robbery  Theft Over
## 1  0.1003022 -0.05975684       0.6193567  0.08152204  0.08407757
## 2  2.6031156  1.73164012       2.6607249  2.40290255  3.24097907
## 3 -0.6432934 -0.42774132      -0.7090994 -0.61474092 -0.54109949
## 4  1.0426316  0.67577638       0.6239794  1.00004211  0.58946987
## 5 -0.2271916 -0.05869507      -0.2893964 -0.18812825 -0.31797748
## 
## Clustering vector:
##   [1] 1 1 3 2 1 5 2 5 3 1 3 4 1 4 3 5 3 3 5 1 3 3 3 2 4 5 5 5 5 3 1 1 4 4 3
##  [36] 1 3 1 3 5 3 5 3 5 3 3 4 5 3 3 5 3 5 5 3 4 5 3 3 2 5 3 1 2 5 3 1 3 3 3
##  [71] 3 3 3 3 4 3 3 1 4 3 2 5 4 3 1 5 1 5 1 3 1 5 1 3 3 5 1 5 3 3 3 5 3 5 1
## [106] 1 4 3 3 5 5 4 1 5 5 5 5 5 3 3 1 1 3 2 4 2 5 5 3 4 4 3 5 4 3 3 3 3 3 2
## [141] 4
## 
## Within cluster sum of squares by cluster:
## [1]  16.14354 152.52923  12.53869  33.77676  13.91044
##  (between_SS / total_SS =  67.3 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;</code></pre>
</div>
<div id="interpretataion" class="section level3">
<h3>Interpretataion</h3>
<ul>
<li><p>K-means algorithm gave us 5 clusters with listed amount of neighbourhoods in each.</p></li>
<li><p>Cluster means: If the ranges of these numbers seem strange, it’s because we standardized the data before performing the cluster analysis. The negative values mean “lower than most” and positive values mean “higher than most”.</p></li>
<li><p>Clustering vector: the first neighbourhood (alphabetically?) belongs to listed cluster number, the second belongs to the next one, and so on.</p></li>
<li><p>A measurements that are more relative would be the withinss and betweenss. Withinss tells us the sum of the square of the distance from each data point to the cluster center. Lower is better. Betweenss tells us the sum of the squared distance between cluster centers. Ideally we want cluster centers far apart from each other. Higher would be better.</p></li>
</ul>
</div>
<div id="plotting-k-5" class="section level3">
<h3>Plotting k = 5</h3>
<pre class="r"><code>z1 &lt;- data.frame(z, kc$cluster)
clusplot(z1, kc$cluster, color=TRUE, shade=F, labels=0, lines=0, main=&#39;k-Means Cluster Analysis k=5&#39;)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/clusplot%20k%205-1.png" width="672" /></p>
</div>
<div id="fitting-a-model-k-10" class="section level3">
<h3>Fitting a model, K = 10</h3>
<pre class="r"><code>kc &lt;- kmeans(z, 10)
kc</code></pre>
<pre><code>## K-means clustering with 10 clusters of sizes 26, 1, 11, 6, 24, 16, 22, 9, 2, 24
## 
## Cluster means:
##       Assault Auto Theft Break and Enter     Robbery  Theft Over
## 1  -0.7275415 -0.5320509      -0.8472560 -0.73720407 -0.58978790
## 2   1.2585733  9.6945198       2.4313261  2.05720435  4.75019073
## 3   0.2882257  0.6244522       1.0352809  0.32106329  0.78960483
## 4   2.3460937  0.9123407       2.5334647  1.40731446  3.30520085
## 5  -0.3397571 -0.3504884      -0.7034876 -0.27924361 -0.52703273
## 6  -0.1519249  0.1451163      -0.1542444 -0.01080156 -0.26813871
## 7   0.2424271 -0.1908809       0.4551731  0.07636603  0.03317452
## 8   1.3761009  0.7324192       0.4262353  1.52159956  0.27607391
## 9   4.0464524  0.2080985       3.1572046  5.56251593  2.29370793
## 10 -0.6173241 -0.2051226      -0.3251779 -0.60376211 -0.36647830
## 
## Clustering vector:
##   [1]  6  3 10  4  7  6  4 10  1  3  5  8  7  8  1  6 10  1  5  7  1  1  1
##  [24]  9  3 10  6  5  7  1  7  3  8  8  5  7 10  7  5  6  1 10  1  5 10 10
##  [47]  8 10  1  1  6 10  5 10 10  3  6  1  5  4  6  5  7  4  6  1  7  1 10
##  [70] 10 10 10 10  1  8  1  1  3  7  5  9  5  8  1  7  5  7  6  7  5  7  5
##  [93]  7  5  1 10  7 10 10  1  1  5  5  6  7  7  3  5  5  6  7  3  7 10  6
## [116]  6  5 10  5  5  7  7  1  4  8  2 10  6  5  3  3  1  6  8  5  1 10  1
## [139]  1  4  3
## 
## Within cluster sum of squares by cluster:
##  [1]  3.070321  0.000000 10.783056 32.414426  4.290106  5.424345 12.352458
##  [8] 15.813567 10.893997  4.728976
##  (between_SS / total_SS =  85.7 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;</code></pre>
</div>
<div id="plotting-k-10" class="section level3">
<h3>Plotting k = 10</h3>
<pre class="r"><code>z1 &lt;- data.frame(z, kc$cluster)
clusplot(z1, kc$cluster, color=TRUE, shade=F, labels=0, lines=0, main=&#39;k-Means Cluster Analysis k=10&#39;)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/clusplot%20k%2010-1.png" width="672" /></p>
</div>
</div>
<div id="hierarchical-clustering" class="section level2">
<h2>6. Hierarchical Clustering</h2>
<div id="dendrogram-plot" class="section level3">
<h3>Dendrogram plot</h3>
<pre class="r"><code>z2 &lt;- data.frame(z)
distance &lt;- dist(z2)
hc &lt;- hclust(distance)</code></pre>
<pre class="r"><code>plot(hc, labels = groups_wide$Neighbourhood, main=&#39;Cluster Dendrogram&#39;, cex=0.65)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/dendrogram%20plot-1.png" width="672" /></p>
</div>
<div id="silhouette-plot" class="section level3">
<h3>Silhouette plot</h3>
<pre class="r"><code>plot(silhouette(cutree(hc, 5), distance))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/silhouette%20k%205-1.png" width="672" /></p>
<pre class="r"><code>plot(silhouette(cutree(hc, 10), distance))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/silhouette%20k%2010-1.png" width="672" /></p>
<pre class="r"><code>plot(silhouette(cutree(hc, 2), distance))</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/silhouette%20k%202-1.png" width="672" /></p>
</div>
</div>
<div id="map-of-toronto-crimes-2014-2018" class="section level2">
<h2>Map of Toronto Crimes 2014-2018</h2>
<pre class="r"><code>lat &lt;- toronto$Lat
lon &lt;- toronto$Long
crimes &lt;- toronto$MCI
to_map &lt;- data.frame(crimes, lat, lon)
colnames(to_map) &lt;- c(&#39;crimes&#39;, &#39;lat&#39;, &#39;lon&#39;)

sbbox &lt;- make_bbox(lon = toronto$Long, lat = toronto$Lat, f = 0.01)
my_map &lt;- get_map(location = sbbox, maptype = &quot;roadmap&quot;, scale = 2, color=&quot;bw&quot;, zoom = 10)</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/285/372.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/286/372.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/285/373.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/286/373.png</code></pre>
<pre class="r"><code>ggmap(my_map) +
  geom_point(data=to_map, aes(x = lon, y = lat, color = &quot;#27AE60&quot;), 
             size = 0.5, alpha = 0.03) +
  xlab(&#39;Longitude&#39;) +
  ylab(&#39;Latitude&#39;) +
  ggtitle(&#39;Location of Major Crime Indicators Toronto 2014-2018&#39;) +
  guides(color=FALSE)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/major%20crimes%20map-1.png" width="672" /></p>
<div id="location-of-major-crime-indicators" class="section level3">
<h3>Location of major crime indicators</h3>
<pre class="r"><code>ggmap(my_map) +
  geom_point(data=to_map, aes(x = lon, y = lat, color = &quot;#27AE60&quot;), 
             size = 0.5, alpha = 0.05) +
  xlab(&#39;Longitude&#39;) +
  ylab(&#39;Latitude&#39;) +
  ggtitle(&#39;Location of Major Crime Indicators Toronto 2014-2018&#39;) +
  guides(color=FALSE) +
  facet_wrap(~ crimes, nrow = 2)</code></pre>
<p><img src="2019-09-04-Toronto_MCI_files/figure-html/maps%20one%20per%20major%20crime-1.png" width="672" /></p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
